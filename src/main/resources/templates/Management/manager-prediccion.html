<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Predecir Ventas</title>
    <link th:href="@{/css/bootstrap.min.css}" rel="stylesheet">
    <link rel="stylesheet" href="/css/importJakartaFont.css">
    <link rel="icon" href="/img/Logo.png" type="image/png">
</head>

<body class="container-fluid jakarta-regular">
<main class="row flex-nowrap">
    <div class="col-3 border-end p-0">
        <div class="d-flex flex-column flex-shrink-0 p-3 bg-body-tertiary min-vh-100">

            <a href="/manager/dashboard"
               class="d-flex align-items-center mb-3 link-body-emphasis text-decoration-none">
                <img src="/img/Logo.png" width="40" height="32" class="me-2">
                <span class="fs-4 jakarta-bold">PlayApp</span>
            </a>

            <hr>

            <ul class="nav nav-pills flex-column mb-auto">

                <li><a href="/manager/dashboard" class="nav-link link-body-emphasis">
                    <img src="/img/icons/speedometer2.svg" width="16" height="16" class="me-2">
                    Dashboard
                </a></li>

                <li><a href="/manager/orders" class="nav-link link-body-emphasis">
                    <img src="/img/icons/stickies.svg" width="16" height="16" class="me-2">
                    Ordenes
                </a></li>

                <li><a href="/manager/products" class="nav-link link-body-emphasis">
                    <img src="/img/icons/boxes.svg" width="16" height="16" class="me-2">
                    Catalogo
                </a></li>

                <li><a href="/manager/prediccion" class="nav-link active">
                    <img src="/img/icons/graph-up.svg" width="16" height="16" class="me-2">
                    Predecir Ventas
                </a></li>

            </ul>

            <hr>

            <div class="dropdown">
                <a href="#" class="d-flex align-items-center link-body-emphasis dropdown-toggle"
                   data-bs-toggle="dropdown">
                    <img src="https://github.com/mdo.png" width="32" height="32" class="rounded-circle me-2">
                    <strong th:text="${nombreRestaurante}"></strong>
                </a>
                <ul class="dropdown-menu shadow">
                    <li>
                        <form th:action="@{/logout}" method="post">
                            <button type="submit" class="dropdown-item">Salir</button>
                        </form>
                    </li>
                </ul>
            </div>

        </div>
    </div>

    <div class="col-9 p-4">

        <h2 class="jakarta-bold mb-3">Predicción de Ventas</h2>
        <p class="text-muted mb-4">Ingresa los datos para que el sistema prediga el total de ventas esperadas.</p>

        <form id="formPrediccion" class="row g-3">

            <div class="col-md-6">
                <label class="form-label">Fecha</label>
                <input type="date" class="form-control" id="fecha">
            </div>

            <div class="col-md-6">
                <label class="form-label">Día de la Semana</label>
                <input type="number" min="1" max="7" class="form-control" id="diaSemana">
            </div>

            <div class="col-md-6">
                <label class="form-label">Producto</label>
                <input type="text" class="form-control" id="producto">
            </div>

            <div class="col-md-6">
                <label class="form-label">Categoría</label>
                <select class="form-select" id="categoria">
                    <option>Bebida</option>
                    <option>Comida</option>
                    <option>Servicio</option>
                </select>
            </div>

            <div class="col-md-6">
                <label class="form-label">Precio</label>
                <input type="number" step="0.01" class="form-control" id="precio">
            </div>

            <div class="col-md-6">
                <label class="form-label">Cantidad Vendida</label>
                <input type="number" class="form-control" id="cantidadVendida">
            </div>

            <div class="col-md-6">
                <label class="form-label">Clima</label>
                <select class="form-select" id="clima">
                    <option>Soleado</option>
                    <option>Nublado</option>
                    <option>Lluvioso</option>
                </select>
            </div>

            <div class="col-md-6">
                <label class="form-label">Temporada</label>
                <select class="form-select" id="temporada">
                    <option>Alta</option>
                    <option>Baja</option>
                    <option>Normal</option>
                </select>
            </div>

            <div class="col-12 mt-4">
                <button type="button" class="btn btn-primary" onclick="predecir()">Calcular Predicción</button>
            </div>
        </form>

        <div id="resultado" class="alert alert-info mt-4 d-none"></div>

    </div>
</main>

<script>
    async function predecir() {
        const datos = {
            fecha: document.getElementById('fecha').value,
            diaSemana: parseInt(document.getElementById('diaSemana').value),
            producto: document.getElementById('producto').value,
            categoria: document.getElementById('categoria').value,
            precio: parseFloat(document.getElementById('precio').value),
            cantidadVendida: parseInt(document.getElementById('cantidadVendida').value),
            clima: document.getElementById('clima').value,
            temporada: document.getElementById('temporada').value
        };

        const response = await fetch('/manager/prediccion/predecir', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(datos)
        });

        const json = await response.json();

        const resultDiv = document.getElementById('resultado');
        resultDiv.classList.remove('d-none');
        resultDiv.innerHTML = `<strong>Resultado:</strong> $${json.prediccion.toFixed(2)}`;
    }
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
